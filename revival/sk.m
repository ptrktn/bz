#! /usr/bin/octave -qf
# -*-octave-*-
# SK model DOI: 10.1021/jp9832721
# Szalai and Koros, J. Phys. Chem. A 1998, 102, 6892-6897
#
#

more off

global kf kr;

# small initial concentration for intermediates     
int0 = 0; 
   
x0 = NaN(17, 1);
# x(1): Br-
x0(1) = int0;
# x(2): HOBr
x0(2) = int0;
# x(3): H+
x0(3) = 1.29; # 2.0 M???
# x(4): Br2
x0(4) = 10^(-3);
# x(5): H2O
x0(5) = 55;
# x(6): HBrO2
x0(6) = int0;
# x(7): BrO3-
x0(7) = 8 * 10^(-3);
# x(8): H2BrO2+
x0(8) = int0;
# x(9): Br2O4
x0(9) = int0;
# x(10): BrO2*
x0(10) = int0;
# x(11): H2Q
x0(11) = 5 * 10^(-5);
# x(12): HQ*
x0(12) = int0;
# x(13): Q
x0(13) = 0.0182;
# x(14): CHD
x0(14) = 0.1 ;
# x(15): CHDE
x0(15) = int0;
# x(16): BrCHD
x0(16) = 0.0205;
# x(17): CHED
x0(17) = 0.00425;

# forward reaction rates
kf = NaN(17, 1);
# reverse reaction rates
kr = NaN(17, 1);

kf(1) = 8 * 10^9;
kr(1) = 80;
kf(2) = 2.5 * 10^6;
kr(2) = 2 * 10^(-5);
kf(3) = 1.2;
kr(3) = 3.2;
kf(4) = 2 * 10^6;
kr(4) = 10^8;
kf(5) = 1.7 * 10^5;
kf(6) = 48;
kr(6) = 3.2 * 10^3;
kf(7) = 7.5 * 10^4;
kr(7) = 1.4 * 10^9;
kf(8) = 8 * 10^5;
kf(9) = 8 * 10^9;
kf(10) = 8.8 * 10^8;
kr(10) = 7.7 * 10^(-4);
kf(11) = 2.13 * 10^(-4);
kr(11) = 5.2 * 10^2;
kf(12) = 2.8 * 10^9;
kf(13) = 2.8 * 10^9;
kf(14) = 5 * 10^(-5);
kf(15) = 1.94 * 10^(-4);
kf(16) = 3 * 10^4;
kf(17) = 2 * 10^(-2);
kf(18) = 6 * 10^5;
kf(19) = 10^(-5);


#function j = jac (x, t)
#  j(17, 17) = zeros(17, 17);
#endfunction

#source("sk_jac.m");

function j = jac (x, t)
    global kf kr ;
    j = zeros(17, 17);
    j(1, 1) =  -kf(1)*x(2)*x(3) - kf(2)*x(3)*x(6) - kf(3)*x(3)**2*x(7)  ; 
    j(1, 2) =  -kf(1)*x(1)*x(3) + kf(18)*x(11) + 2*kr(2)*x(2) + kr(3)*x(6)  ; 
    j(1, 3) =  -kf(1)*x(1)*x(2) - kf(2)*x(1)*x(6) - 2*kf(3)*x(1)*x(3)*x(7)  ; 
    j(1, 4) =  kf(12)*x(15) + 2*kf(16)*x(11) + kr(1)*x(5)  ; 
    j(1, 5) =  kr(1)*x(4)  ; 
    j(1, 6) =  -kf(2)*x(1)*x(3) + kr(3)*x(2)  ; 
    j(1, 7) =  -kf(3)*x(1)*x(3)**2  ; 
    j(1, 8) =  0  ; 
    j(1, 9) =  0  ; 
    j(1, 10) =  0  ; 
    j(1, 11) =  2*kf(16)*x(4) + kf(18)*x(2)  ; 
    j(1, 12) =  0  ; 
    j(1, 13) =  0  ; 
    j(1, 14) =  0  ; 
    j(1, 15) =  kf(12)*x(4)  ; 
    j(1, 16) =  kf(14)  ; 
    j(1, 17) =  0  ; 
    j(2, 1) =  -kf(1)*x(2)*x(3) + 2*kf(2)*x(3)*x(6) + kf(3)*x(3)**2*x(7)  ; 
    j(2, 2) =  -kf(1)*x(1)*x(3) - kf(13)*x(15) - kf(18)*x(11) - 2*kr(2)*x(2) - kr(3)*x(6)  ; 
    j(2, 3) =  -kf(1)*x(1)*x(2) + 2*kf(2)*x(1)*x(6) + 2*kf(3)*x(1)*x(3)*x(7)  ; 
    j(2, 4) =  kr(1)*x(5)  ; 
    j(2, 5) =  kr(1)*x(4)  ; 
    j(2, 6) =  2*kf(2)*x(1)*x(3) + kf(5)*x(8) - kr(3)*x(2)  ; 
    j(2, 7) =  kf(3)*x(1)*x(3)**2  ; 
    j(2, 8) =  kf(5)*x(6)  ; 
    j(2, 9) =  0  ; 
    j(2, 10) =  0  ; 
    j(2, 11) =  -kf(18)*x(2)  ; 
    j(2, 12) =  0  ; 
    j(2, 13) =  0  ; 
    j(2, 14) =  0  ; 
    j(2, 15) =  -kf(13)*x(2)  ; 
    j(2, 16) =  0  ; 
    j(2, 17) =  0  ; 
    j(3, 1) =  -kf(1)*x(2)*x(3) - kf(2)*x(3)*x(6) - kf(3)*x(3)**2*x(7)  ; 
    j(3, 2) =  -kf(1)*x(1)*x(3) + kf(18)*x(11) + 2*kr(2)*x(2) + 2*kr(3)*x(6)  ; 
    j(3, 3) =  -kf(1)*x(1)*x(2) - kf(11)*x(14) - kf(17)*x(11)*x(7) - kf(19)*x(14)*x(7) - kf(2)*x(1)*x(6) - 2*kf(3)*x(1)*x(3)*x(7) - kf(6)*x(6)*x(7) - kr(11)*x(15)  ; 
    j(3, 4) =  kf(12)*x(15) + 2*kf(16)*x(11) + kr(1)*x(5)  ; 
    j(3, 5) =  kr(1)*x(4) - kr(6)*x(9)  ; 
    j(3, 6) =  -kf(2)*x(1)*x(3) + 2*kf(5)*x(8) - kf(6)*x(3)*x(7) + 2*kr(3)*x(2)  ; 
    j(3, 7) =  -kf(17)*x(11)*x(3) - kf(19)*x(14)*x(3) - kf(3)*x(1)*x(3)**2 - kf(6)*x(3)*x(6)  ; 
    j(3, 8) =  2*kf(5)*x(6)  ; 
    j(3, 9) =  -kr(6)*x(5)  ; 
    j(3, 10) =  0  ; 
    j(3, 11) =  2*kf(16)*x(4) - kf(17)*x(3)*x(7) + kf(18)*x(2)  ; 
    j(3, 12) =  0  ; 
    j(3, 13) =  0  ; 
    j(3, 14) =  -kf(11)*x(3) - kf(19)*x(3)*x(7)  ; 
    j(3, 15) =  kf(12)*x(4) - kr(11)*x(3)  ; 
    j(3, 16) =  kf(14)  ; 
    j(3, 17) =  0  ; 
    j(4, 1) =  kf(1)*x(2)*x(3)  ; 
    j(4, 2) =  kf(1)*x(1)*x(3)  ; 
    j(4, 3) =  kf(1)*x(1)*x(2)  ; 
    j(4, 4) =  -kf(12)*x(15) - kf(16)*x(11) - kr(1)*x(5)  ; 
    j(4, 5) =  -kr(1)*x(4)  ; 
    j(4, 6) =  0  ; 
    j(4, 7) =  0  ; 
    j(4, 8) =  0  ; 
    j(4, 9) =  0  ; 
    j(4, 10) =  0  ; 
    j(4, 11) =  -kf(16)*x(4)  ; 
    j(4, 12) =  0  ; 
    j(4, 13) =  0  ; 
    j(4, 14) =  0  ; 
    j(4, 15) =  -kf(12)*x(4)  ; 
    j(4, 16) =  0  ; 
    j(4, 17) =  0  ; 
    j(5, 1) =  kf(1)*x(2)*x(3)  ; 
    j(5, 2) =  kf(1)*x(1)*x(3) + kf(13)*x(15) + kf(18)*x(11)  ; 
    j(5, 3) =  kf(1)*x(1)*x(2) + kf(17)*x(11)*x(7) + kf(19)*x(14)*x(7) + kf(6)*x(6)*x(7)  ; 
    j(5, 4) =  -kr(1)*x(5)  ; 
    j(5, 5) =  -kr(1)*x(4) - kr(6)*x(9)  ; 
    j(5, 6) =  kf(6)*x(3)*x(7)  ; 
    j(5, 7) =  kf(17)*x(11)*x(3) + kf(19)*x(14)*x(3) + kf(6)*x(3)*x(6)  ; 
    j(5, 8) =  0  ; 
    j(5, 9) =  -kr(6)*x(5)  ; 
    j(5, 10) =  0  ; 
    j(5, 11) =  kf(17)*x(3)*x(7) + kf(18)*x(2)  ; 
    j(5, 12) =  0  ; 
    j(5, 13) =  0  ; 
    j(5, 14) =  kf(19)*x(3)*x(7)  ; 
    j(5, 15) =  kf(13)*x(2)  ; 
    j(5, 16) =  0  ; 
    j(5, 17) =  0  ; 
    j(6, 1) =  -kf(2)*x(3)*x(6) + kf(3)*x(3)**2*x(7)  ; 
    j(6, 2) =  2*kr(2)*x(2) - kr(3)*x(6)  ; 
    j(6, 3) =  kf(17)*x(11)*x(7) + kf(19)*x(14)*x(7) - kf(2)*x(1)*x(6) + 2*kf(3)*x(1)*x(3)*x(7) - kf(4)*x(6) - kf(6)*x(6)*x(7)  ; 
    j(6, 4) =  0  ; 
    j(6, 5) =  kr(6)*x(9)  ; 
    j(6, 6) =  -kf(2)*x(1)*x(3) - kf(4)*x(3) - kf(5)*x(8) - kf(6)*x(3)*x(7) - kr(3)*x(2)  ; 
    j(6, 7) =  kf(17)*x(11)*x(3) + kf(19)*x(14)*x(3) + kf(3)*x(1)*x(3)**2 - kf(6)*x(3)*x(6)  ; 
    j(6, 8) =  -kf(5)*x(6) + kr(4)  ; 
    j(6, 9) =  kr(6)*x(5)  ; 
    j(6, 10) =  kf(8)*x(11) + kf(9)*x(12)  ; 
    j(6, 11) =  kf(17)*x(3)*x(7) + kf(8)*x(10)  ; 
    j(6, 12) =  kf(9)*x(10)  ; 
    j(6, 13) =  0  ; 
    j(6, 14) =  kf(19)*x(3)*x(7)  ; 
    j(6, 15) =  0  ; 
    j(6, 16) =  0  ; 
    j(6, 17) =  0  ; 
    j(7, 1) =  -kf(3)*x(3)**2*x(7)  ; 
    j(7, 2) =  kr(3)*x(6)  ; 
    j(7, 3) =  -kf(17)*x(11)*x(7) - kf(19)*x(14)*x(7) - 2*kf(3)*x(1)*x(3)*x(7) - kf(6)*x(6)*x(7)  ; 
    j(7, 4) =  0  ; 
    j(7, 5) =  kr(6)*x(9)  ; 
    j(7, 6) =  kf(5)*x(8) - kf(6)*x(3)*x(7) + kr(3)*x(2)  ; 
    j(7, 7) =  -kf(17)*x(11)*x(3) - kf(19)*x(14)*x(3) - kf(3)*x(1)*x(3)**2 - kf(6)*x(3)*x(6)  ; 
    j(7, 8) =  kf(5)*x(6)  ; 
    j(7, 9) =  kr(6)*x(5)  ; 
    j(7, 10) =  0  ; 
    j(7, 11) =  -kf(17)*x(3)*x(7)  ; 
    j(7, 12) =  0  ; 
    j(7, 13) =  0  ; 
    j(7, 14) =  -kf(19)*x(3)*x(7)  ; 
    j(7, 15) =  0  ; 
    j(7, 16) =  0  ; 
    j(7, 17) =  0  ; 
    j(8, 1) =  0  ; 
    j(8, 2) =  0  ; 
    j(8, 3) =  kf(4)*x(6)  ; 
    j(8, 4) =  0  ; 
    j(8, 5) =  0  ; 
    j(8, 6) =  kf(4)*x(3) - kf(5)*x(8)  ; 
    j(8, 7) =  0  ; 
    j(8, 8) =  -kf(5)*x(6) - kr(4)  ; 
    j(8, 9) =  0  ; 
    j(8, 10) =  0  ; 
    j(8, 11) =  0  ; 
    j(8, 12) =  0  ; 
    j(8, 13) =  0  ; 
    j(8, 14) =  0  ; 
    j(8, 15) =  0  ; 
    j(8, 16) =  0  ; 
    j(8, 17) =  0  ; 
    j(9, 1) =  0  ; 
    j(9, 2) =  0  ; 
    j(9, 3) =  kf(6)*x(6)*x(7)  ; 
    j(9, 4) =  0  ; 
    j(9, 5) =  -kr(6)*x(9)  ; 
    j(9, 6) =  kf(6)*x(3)*x(7)  ; 
    j(9, 7) =  kf(6)*x(3)*x(6)  ; 
    j(9, 8) =  0  ; 
    j(9, 9) =  -kf(7) - kr(6)*x(5)  ; 
    j(9, 10) =  2*kr(7)*x(10)  ; 
    j(9, 11) =  0  ; 
    j(9, 12) =  0  ; 
    j(9, 13) =  0  ; 
    j(9, 14) =  0  ; 
    j(9, 15) =  0  ; 
    j(9, 16) =  0  ; 
    j(9, 17) =  0  ; 
    j(10, 1) =  0  ; 
    j(10, 2) =  0  ; 
    j(10, 3) =  0  ; 
    j(10, 4) =  0  ; 
    j(10, 5) =  0  ; 
    j(10, 6) =  0  ; 
    j(10, 7) =  0  ; 
    j(10, 8) =  0  ; 
    j(10, 9) =  2*kf(7)  ; 
    j(10, 10) =  -kf(8)*x(11) - kf(9)*x(12) - 2*kr(7)*x(10)  ; 
    j(10, 11) =  -kf(8)*x(10)  ; 
    j(10, 12) =  -kf(9)*x(10)  ; 
    j(10, 13) =  0  ; 
    j(10, 14) =  0  ; 
    j(10, 15) =  0  ; 
    j(10, 16) =  0  ; 
    j(10, 17) =  0  ; 
    j(11, 1) =  0  ; 
    j(11, 2) =  -kf(18)*x(11)  ; 
    j(11, 3) =  kf(15)*x(17) - kf(17)*x(11)*x(7) + kf(19)*x(14)*x(7)  ; 
    j(11, 4) =  -kf(16)*x(11)  ; 
    j(11, 5) =  0  ; 
    j(11, 6) =  0  ; 
    j(11, 7) =  -kf(17)*x(11)*x(3) + kf(19)*x(14)*x(3)  ; 
    j(11, 8) =  0  ; 
    j(11, 9) =  0  ; 
    j(11, 10) =  -kf(8)*x(11)  ; 
    j(11, 11) =  -kf(16)*x(4) - kf(17)*x(3)*x(7) - kf(18)*x(2) - kf(8)*x(10) - kr(10)*x(13)  ; 
    j(11, 12) =  2*kf(10)*x(12)  ; 
    j(11, 13) =  -kr(10)*x(11)  ; 
    j(11, 14) =  kf(19)*x(3)*x(7)  ; 
    j(11, 15) =  0  ; 
    j(11, 16) =  0  ; 
    j(11, 17) =  kf(15)*x(3)  ; 
    j(12, 1) =  0  ; 
    j(12, 2) =  0  ; 
    j(12, 3) =  0  ; 
    j(12, 4) =  0  ; 
    j(12, 5) =  0  ; 
    j(12, 6) =  0  ; 
    j(12, 7) =  0  ; 
    j(12, 8) =  0  ; 
    j(12, 9) =  0  ; 
    j(12, 10) =  kf(8)*x(11) - kf(9)*x(12)  ; 
    j(12, 11) =  kf(8)*x(10) + 2*kr(10)*x(13)  ; 
    j(12, 12) =  -2*kf(10)*x(12) - kf(9)*x(10)  ; 
    j(12, 13) =  2*kr(10)*x(11)  ; 
    j(12, 14) =  0  ; 
    j(12, 15) =  0  ; 
    j(12, 16) =  0  ; 
    j(12, 17) =  0  ; 
    j(13, 1) =  0  ; 
    j(13, 2) =  kf(18)*x(11)  ; 
    j(13, 3) =  kf(17)*x(11)*x(7)  ; 
    j(13, 4) =  kf(16)*x(11)  ; 
    j(13, 5) =  0  ; 
    j(13, 6) =  0  ; 
    j(13, 7) =  kf(17)*x(11)*x(3)  ; 
    j(13, 8) =  0  ; 
    j(13, 9) =  0  ; 
    j(13, 10) =  kf(9)*x(12)  ; 
    j(13, 11) =  kf(16)*x(4) + kf(17)*x(3)*x(7) + kf(18)*x(2) - kr(10)*x(13)  ; 
    j(13, 12) =  2*kf(10)*x(12) + kf(9)*x(10)  ; 
    j(13, 13) =  -kr(10)*x(11)  ; 
    j(13, 14) =  0  ; 
    j(13, 15) =  0  ; 
    j(13, 16) =  0  ; 
    j(13, 17) =  0  ; 
    j(14, 1) =  0  ; 
    j(14, 2) =  0  ; 
    j(14, 3) =  -kf(11)*x(14) - kf(19)*x(14)*x(7) + kr(11)*x(15)  ; 
    j(14, 4) =  0  ; 
    j(14, 5) =  0  ; 
    j(14, 6) =  0  ; 
    j(14, 7) =  -kf(19)*x(14)*x(3)  ; 
    j(14, 8) =  0  ; 
    j(14, 9) =  0  ; 
    j(14, 10) =  0  ; 
    j(14, 11) =  0  ; 
    j(14, 12) =  0  ; 
    j(14, 13) =  0  ; 
    j(14, 14) =  -kf(11)*x(3) - kf(19)*x(3)*x(7)  ; 
    j(14, 15) =  kr(11)*x(3)  ; 
    j(14, 16) =  0  ; 
    j(14, 17) =  0  ; 
    j(15, 1) =  0  ; 
    j(15, 2) =  -kf(13)*x(15)  ; 
    j(15, 3) =  kf(11)*x(14) - kr(11)*x(15)  ; 
    j(15, 4) =  -kf(12)*x(15)  ; 
    j(15, 5) =  0  ; 
    j(15, 6) =  0  ; 
    j(15, 7) =  0  ; 
    j(15, 8) =  0  ; 
    j(15, 9) =  0  ; 
    j(15, 10) =  0  ; 
    j(15, 11) =  0  ; 
    j(15, 12) =  0  ; 
    j(15, 13) =  0  ; 
    j(15, 14) =  kf(11)*x(3)  ; 
    j(15, 15) =  -kf(12)*x(4) - kf(13)*x(2) - kr(11)*x(3)  ; 
    j(15, 16) =  0  ; 
    j(15, 17) =  0  ; 
    j(16, 1) =  0  ; 
    j(16, 2) =  kf(13)*x(15)  ; 
    j(16, 3) =  0  ; 
    j(16, 4) =  kf(12)*x(15)  ; 
    j(16, 5) =  0  ; 
    j(16, 6) =  0  ; 
    j(16, 7) =  0  ; 
    j(16, 8) =  0  ; 
    j(16, 9) =  0  ; 
    j(16, 10) =  0  ; 
    j(16, 11) =  0  ; 
    j(16, 12) =  0  ; 
    j(16, 13) =  0  ; 
    j(16, 14) =  0  ; 
    j(16, 15) =  kf(12)*x(4) + kf(13)*x(2)  ; 
    j(16, 16) =  -kf(14)  ; 
    j(16, 17) =  0  ; 
    j(17, 1) =  0  ; 
    j(17, 2) =  0  ; 
    j(17, 3) =  -kf(15)*x(17)  ; 
    j(17, 4) =  0  ; 
    j(17, 5) =  0  ; 
    j(17, 6) =  0  ; 
    j(17, 7) =  0  ; 
    j(17, 8) =  0  ; 
    j(17, 9) =  0  ; 
    j(17, 10) =  0  ; 
    j(17, 11) =  0  ; 
    j(17, 12) =  0  ; 
    j(17, 13) =  0  ; 
    j(17, 14) =  0  ; 
    j(17, 15) =  0  ; 
    j(17, 16) =  kf(14)  ; 
    j(17, 17) =  -kf(15)*x(3)  ; 
endfunction


function xdot = f (x, t)
  global kf kr;
  
  xdot = zeros(17, 1);
  
  fkinet(1) = kf(1) * x(1) * x(2) * x(3);
  rkinet(1) = kr(1) * x(4) * x(5);
  fkinet(2) = kf(2) * x(1) * x(6) * x(3);
  rkinet(2) = kr(2) * x(2) * x(2);
  fkinet(3) = kf(3) * x(1) * x(7) * x(3) * x(3);
  rkinet(3) = kr(3) * x(2) * x(6);
  fkinet(4) = kf(4) * x(6) * x(3);
  rkinet(4) = kr(4) * x(8);
  fkinet(5) = kf(5) * x(6) * x(8);
  fkinet(6) = kf(6) * x(6) * x(7) * x(3);
  rkinet(6) = kr(6) * x(9) * x(5);
  fkinet(7) = kf(7) * x(9);
  rkinet(7) = kr(7) * x(10) * x(10);
  fkinet(8) = kf(8) * x(11) * x(10);
  fkinet(9) = kf(9) * x(12) * x(10);
  fkinet(10) = kf(10) * x(12) * x(12);
  rkinet(10) = kr(10) * x(11) * x(13);
  fkinet(11) = kf(11) * x(14) * x(3);
  rkinet(11) = kr(11) * x(15) * x(3);
  fkinet(12) = kf(12) * x(15) * x(4);
  fkinet(13) = kf(13) * x(15) * x(2);
  fkinet(14) = kf(14) * x(16);
  fkinet(15) = kf(15) * x(17) * x(3);
  fkinet(16) = kf(16) * x(11) * x(4);
  fkinet(17) = kf(17) * x(11) * x(3) * x(7);
  fkinet(18) = kf(18) * x(11) * x(2);
  fkinet(19) = kf(19) * x(14) * x(7) * x(3); 

  
  # Table 3
  # x(1): Br-
  xdot(1) =  - fkinet(1) + rkinet(1) ;          # R1
  xdot(1) += - fkinet(2) + rkinet(2) ;         # R2
  xdot(1) += - fkinet(3) + rkinet(3) ;         # R3
  xdot(1) +=   fkinet(12) ;                    # R12
  xdot(1) +=   fkinet(14) ;                    # R14
  xdot(1) +=   2 *  fkinet(16) ;               # R16
  xdot(1) +=   fkinet(18) ;                   # R18
  # x(2): HOBr
  xdot(2) =  - fkinet(1) + rkinet(1) ;         # R1
  xdot(2) +=   2 * fkinet(2) - rkinet(2) ;     # R2
  xdot(2) +=   fkinet(3) - rkinet(3) ;         # R3
  xdot(2) +=   fkinet(5) ;                     # R5
  xdot(2) += - fkinet(13) ;                    # R13
  xdot(2) += - fkinet(18) ;                    # R18  
  # x(3): H+
  xdot(3) =  - fkinet(1) + rkinet(1) ;         # R1
  xdot(3) += - fkinet(2) + rkinet(2) ;         # R2
  xdot(3) += - fkinet(3) + 2 * rkinet(3) ;     # R3
  xdot(3) += - rkinet(4) + rkinet(4) ;         # R4
  xdot(3) +=   2 * fkinet(5) ;                 # R5
  xdot(3) += - fkinet(6) - rkinet(6) ;         # R6
  xdot(3) += - fkinet(11) - rkinet(11) ;       # R11
  xdot(3) +=   fkinet(12) ;                    # R12
  xdot(3) +=   fkinet(14) ;                    # R14
  # CHED + H+ -> H2Q + H+
  # xdot(3) += - fkinet(15)  ;                 # R15 CHECK
  xdot(3) +=   2 * fkinet(16) ;                # R16
  xdot(3) += - fkinet(17) ;                    # R17
  xdot(3) +=   fkinet(18) ;                    # R18
  xdot(3) += - fkinet(19) ;                    # R19
  # x(4): Br2
  xdot(4) =    fkinet(1) - rkinet(1) ;         # R1
  xdot(4) += - fkinet(12) ;                    # R12
  xdot(4) += - fkinet(16) ;                    # R16
  # x(5): H2O
  xdot(5) =    fkinet(1) - rkinet(1) ;         # R1
  xdot(5) +=   fkinet(6) - rkinet(6) ;         # R6
  xdot(5) +=   fkinet(13) ;                    # R13
  xdot(5) +=   fkinet(17) ;                    # R17
  xdot(5) +=   fkinet(18) ;                    # R18
  xdot(5) +=   fkinet(19) ;                    # R19
  # x(6): HBrO2
  xdot(6) =  - fkinet(2) + rkinet(2) ;         # R2
  xdot(6) +=   fkinet(3) - rkinet(3) ;         # R3
  xdot(6) += - fkinet(4) + rkinet(4) ;         # R4
  xdot(6) += - fkinet(5) ;                     # R5
  xdot(6) += - fkinet(6) + rkinet(6) ;         # R6
  xdot(6) +=   fkinet(8) ;                     # R8
  xdot(6) +=   fkinet(9) ;                     # R9
  xdot(6) +=   fkinet(17) ;                    # R17
  xdot(6) +=   fkinet(19) ;                    # R19
  # x(7): BrO3-
  xdot(7) =   - fkinet(3) + rkinet(3) ;        # R3
  xdot(7) +=    fkinet(5) ;                    # R5
  xdot(7) +=  - fkinet(6) + rkinet(6) ;        # R6
  xdot(7) +=  - fkinet(17) ;                   # R17
  xdot(7) +=  - fkinet(19) ;                   # R19
  # x(8): H2BrO2+
  xdot(8) =    fkinet(4) - rkinet(4) ;         # R4
  xdot(8) += - fkinet(5) ;                     # R5
  # x(9): Br2O4
  xdot(9) =    fkinet(6) - rkinet(6) ;         # R6
  xdot(9) += - fkinet(7) + rkinet(7) ;         # R7
  # x(10): BrO2*
  xdot(10) =    2 * fkinet(7) - rkinet(7) ;    # R7
  xdot(10) += - fkinet(8) ;                    # R8
  xdot(10) += - fkinet(9) ;                    # R9
  # x(11): H2Q
  xdot(11) =   - fkinet(8) ;                   # R8
  xdot(11) +=    fkinet(10) - rkinet(10) ;     # R10
  xdot(11) +=    fkinet(15) ;                  # R15
  xdot(11) +=  - fkinet(16) ;                  # R16
  xdot(11) +=  - fkinet(17) ;                  # R17
  xdot(11) +=  - fkinet(18) ;                  # R18
  xdot(11) +=    fkinet(19) ;                  # R19
  # x(12): HQ*
  xdot(12) =    fkinet(8) ;                    # R8
  xdot(12) += - fkinet(9) ;                    # R9
  xdot(12) += - fkinet(10) + 2 * rkinet(10) ;  # R10
  # x(13): Q
  xdot(13) =    fkinet(9) ;                    # R9
  xdot(13) +=   fkinet(10) - rkinet(10) ;      # R10
  xdot(13) +=   fkinet(16) ;                   # R16
  xdot(13) +=   fkinet(17) ;                   # R17
  xdot(13) +=   fkinet(18) ;                   # R18
  # x(14): CHD
  xdot(14) =  - fkinet(11) + rkinet(11) ;      # R11
  xdot(14) += - fkinet(19) ;                   # R19
  # x(15): CHDE
  xdot(15) =    fkinet(11) - rkinet(11) ;      # R11
  xdot(15) += - fkinet(12) ;                   # R12
  xdot(15) += - fkinet(13) ;                   # R13
  # x(16): BrCHD
  xdot(16) =    fkinet(12) ;                   # R12
  xdot(16) +=   fkinet(13) ;                   # R13
  xdot(16) += - fkinet(14) ;                   # R14
  # x(17): CHED
  xdot(17) =    fkinet(14) ;                   # R14
  xdot(17) += - fkinet(15) ;                   # R15
 
  
endfunction

usej = 1;
useplot = 0;
t1 = 5000;

tsteps = 100 * t1;
t = linspace (0, t1, tsteps);

lsode_options("integration method", "stiff");
lsode_options("absolute tolerance", 1e-5);
lsode_options("relative tolerance", 1e-5);

if 0 == usej
  y = lsode ("f", x0, t);  
else
  y = lsode ({@f, @jac}, x0, t);
endif

if 1 == useplot

h1 = figure();

plot (t, y);

xlabel("time");
ylabel("concentration");

title(cstrcat(
			  "SK model ",
        ""
			  )
	  );

#legend("[HBrO_2]", "[Br^-]", "[H_2Q]");

print(h1, "sk.jpg", "-djpg");

else
  
  #d = [rot90(t, -1), y];
  #d = [rot90(t, -1), y(:, 6), y(:, 1), y(:, 11)];
  d = [rot90(t, -1), y(:, 11)];
  save plot.mat d;

endif



